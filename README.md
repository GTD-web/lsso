# lsso

루미르 로그인 중앙화 프로젝트

## 테스트 방법

### End-to-End 테스트

이 프로젝트는 종단간(End-to-End) 테스트를 위해 TestContainers를 사용하여 테스트용 PostgreSQL 데이터베이스를 생성하고 관리합니다. 각 테스트 실행 시 격리된 환경에서 테스트가 실행되며, 테스트 완료 후 컨테이너는 자동으로 제거됩니다.

#### 테스트 흐름

통합 워크플로우 테스트(`workflow.e2e-spec.ts`)는 실제 애플리케이션의 워크플로우를 따라 데이터를 순차적으로 생성하고 검증합니다:

1. **시스템 관리**: 시스템 생성, 조회, 업데이트 기능 테스트
2. **시스템 인증**: 시스템 토큰 발급 테스트
3. **사용자 동기화**: 외부 시스템과의 사용자 동기화 테스트
4. **사용자 인증**: 사용자 로그인, 토큰 검증 테스트
5. **통합 테스트**: 발급된 토큰을 사용한 API 접근 테스트

이 테스트는 각 단계를 순차적으로 진행하면서 이전 단계에서 생성된 데이터를 활용하여 애플리케이션의 통합 동작을 검증합니다.

#### 테스트 실행 방법

```bash
# 전체 E2E 테스트 실행
pnpm test:e2e

# 특정 테스트 실행
pnpm test:e2e:auth      # 인증 테스트만 실행
pnpm test:e2e:user      # 사용자 동기화 테스트만 실행
pnpm test:e2e:system    # 시스템 테스트만 실행
pnpm test:e2e:workflow  # 전체 워크플로우 테스트 실행
```

#### 테스트 실행 환경

테스트를 실행하기 위해서는 Docker가 실행 중이어야 합니다. TestContainers는 자동으로 PostgreSQL 컨테이너를 생성하고 관리합니다.

#### 테스트 시 주의사항

1. 로깅 인터셉터는 테스트에서 제외됩니다 - 테스트에서는 로그 기록을 남기지 않습니다.
2. 테스트는 실제 구현된 API 엔드포인트에 맞춰 작성되어야 합니다.
3. 실행 순서가 중요합니다 - 워크플로우 테스트는 정해진 순서대로 실행되어야 합니다.
